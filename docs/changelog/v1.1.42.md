# v1.1.42：修复速率限制问题，改进 Fork 会话命名

**发布日期**：2026年01月29日

---

## 一句话总结

这次更新修复了 Copilot 的速率限制问题，并改进了 Fork 会话的标题命名方式。

---

## 问题修复：Copilot 速率限制问题

### 之前的问题

使用 Copilot 时，由于使用了新的 Messages API，可能会遇到速率限制问题。

### 现在的情况

回退到 Anthropic completions endpoint，避免了速率限制问题，Copilot 现在可以更稳定地工作。

---

## 问题修复：Frontmatter 换行问题

### 之前的问题

Frontmatter 处理时会添加不必要的换行符，导致模型 ID 无效。

### 现在的情况

修复了 frontmatter 处理逻辑，不再添加多余的换行符，模型 ID 可以正确解析。

---

## 问题修复：Kimi 假变体

### 之前的问题

Kimi 模型会显示一些不存在的变体（fake variants）。

### 现在的情况

修复了这个问题，Kimi 模型现在只显示真实的可用变体。

---

## 新功能：Fork 会话顺序编号

### 这次更新了什么？

Fork 会话时，会话标题现在会自动添加顺序编号，避免名称冲突。

### Fork 会话是什么？

Fork 会话是从现有会话创建的新会话副本，适合在保留原会话的同时尝试不同的方向。

### 如何使用？

1. 右键点击想要 fork 的会话
2. 选择 "Fork" 选项
3. 新会话会自动命名为 "原会话名 (2)"、"原会话名 (3)" 等

---

## 新功能：CLI 统计包含缓存 Token

### 这次更新了什么？

CLI 的统计信息现在包含了缓存的 Token 数量，让你更全面地了解 Token 使用情况。

### 如何查看？

运行命令：
```bash
opencode stats
```

现在可以看到包括缓存在内的完整 Token 统计。

---

## 问题修复：超时保护

### 之前的问题

在某些情况下，超时回调可能导致已销毁的输入字段被访问。

### 现在的情况

添加了额外的超时竞态条件保护，确保不会访问已销毁的输入字段。

---

## 要不要升级？

| 情况 | 建议 |
|------|------|
| 使用 Copilot | ✅ 强烈推荐（修复速率限制） |
| 使用 Kimi 模型 | ✅ 推荐升级（修复变体问题） |
| 经常 Fork 会话 | ✅ 推荐升级（改进命名） |
| 用得好好的 | 可以等下次 |

**升级命令**：

```bash
opencode upgrade
```

---

## 技术细节（可跳过）

<details>
<summary>点击展开完整更新列表</summary>

### Core
- Revert to Anthropic completions endpoint to avoid rate limiting issues with copilot
- Fix frontmatter adding newlines causing invalid model IDs
- Ensure that Kimi doesn't have fake variants available
- Add sequential numbering for forked session titles (@ariane-emory)

### TUI
- Add additional timeout race condition guards
- Guard destroyed input field in timeout callback
- Include cache tokens in CLI statistics (@bold84)

**Thank you to 2 community contributors:**

@bold84:
- feat(cli): include cache tokens in stats (#10582)

@ariane-emory:
- feat: Sequential numbering for forked session titles (Issue #10105) (#10321)

</details>

---

[← 返回更新日志](./index.md)
